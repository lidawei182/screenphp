"use strict";(self["webpackChunkdatafication"]=self["webpackChunkdatafication"]||[]).push([[251,494],{72251:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[e.showSearch?t("div",{staticClass:"filter-container"},[t("el-form",{staticClass:"form-inline",attrs:{inline:!0,model:e.listQuery}},[t("el-form-item",{attrs:{label:""}},[t("el-input",{attrs:{placeholder:"账号",clearable:"",size:"small"},model:{value:e.listQuery.userName,callback:function(t){e.$set(e.listQuery,"userName",t)},expression:"listQuery.userName"}})],1),t("el-form-item",{attrs:{label:""}},[t("el-input",{attrs:{placeholder:"手机号",clearable:"",size:"small"},model:{value:e.listQuery.phone,callback:function(t){e.$set(e.listQuery,"phone",t)},expression:"listQuery.phone"}})],1),t("el-form-item",{attrs:{label:""}},[t("el-input",{attrs:{placeholder:"姓名",clearable:"",size:"small"},model:{value:e.listQuery.realName,callback:function(t){e.$set(e.listQuery,"realName",t)},expression:"listQuery.realName"}})],1),t("el-form-item",{attrs:{label:""}},[t("el-select",{attrs:{placeholder:"状态",clearable:"",size:"small"},model:{value:e.listQuery.isEnabled,callback:function(t){e.$set(e.listQuery,"isEnabled",t)},expression:"listQuery.isEnabled"}},[t("el-option",{attrs:{label:"全部",value:"-1"}}),t("el-option",{attrs:{label:"正常",value:"1"}}),t("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),t("el-form-item",{attrs:{label:""}},[t("el-date-picker",{attrs:{"picker-options":e.pickerOptions,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",align:"right",clearable:"",size:"small"},model:{value:e.dateTime,callback:function(t){e.dateTime=t},expression:"dateTime"}})],1),t("el-form-item",[t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleFilter}},[e._v("搜索")])],1),t("el-form-item",[t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"warning",icon:"el-icon-refresh",size:"small"},on:{click:e.handleFilterClear}},[e._v("重置")])],1)],1)],1):e._e(),t("el-row",{staticStyle:{"margin-bottom":"10px"}},[t("el-col",{attrs:{xs:24,sm:24,lg:24}},[t("el-tooltip",{attrs:{content:"刷新",placement:"top"}},[t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"warning",icon:"el-icon-refresh",circle:""},on:{click:e.handleFilterClear}})],1),t("el-tooltip",{attrs:{content:"更多",placement:"top"}},[t("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{trigger:"click",placement:"bottom"},on:{command:e.handleCommand}},[t("el-button",{attrs:{disabled:e.buttonDisabled,type:"Info",circle:""}},[t("i",{staticClass:"el-icon-more"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"1"}},[e._v("设为正常")]),t("el-dropdown-item",{attrs:{command:"0"}},[e._v("设为禁用")])],1)],1)],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticClass:"headercellclassname",staticStyle:{width:"100%"},attrs:{data:e.list,stripe:"","row-style":{backgroundColor:"#000e21"},"cell-style":{borderColor:"#000e21"},"header-cell-style":{background:"#011531",borderColor:"#000e21"},border:"",fit:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{label:"设备序列码",align:"center",width:"300",fixed:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.UnitNo))])]}}])}),t("el-table-column",{attrs:{label:"账号",width:"150px",align:"center",fixed:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"link-type",on:{click:function(t){return e.handleUpdate(a.$index,a.row.id)}}},[e._v(e._s(a.row.userName))])]}}])}),t("el-table-column",{attrs:{label:"手机",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.phone))])]}}])}),t("el-table-column",{attrs:{label:"邮箱",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.email))])]}}])}),t("el-table-column",{attrs:{label:"标题","min-width":"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.realName))])]}}])}),t("el-table-column",{attrs:{label:"状态",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{class:{"el-icon-success text-green":1==a.row.isEnabled,"el-icon-error text-red":0==a.row.isEnabled},on:{click:function(t){return e.handleModifyStatus(a.$index,a.row.id,a.row.isEnabled)}}},[e._v(e._s(e._f("statusFilter")(a.row.isEnabled)))])]}}])}),t("el-table-column",{attrs:{label:"注册时间",width:"160px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("parseTime")(a.row.regTime,"{y}-{m}-{d} {h}:{i}:{s}")))])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"120px","class-name":"small-padding fixed-width",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tooltip",{attrs:{content:"编辑",placement:"top"}},[t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",icon:"el-icon-edit-outline",circle:""},on:{click:function(t){return e.handleUpdate(a.$index,a.row.id)}}})],1),t("el-tooltip",{attrs:{content:"删除",placement:"top"}},[t("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{loading:a.row.delete,type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(t){return e.handleDelete(a.$index,a.row.id)}}})],1)]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.psize,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("adminForm",{ref:"fromAdmin",on:{updateRow:e.updateRow}})],1)},i=[],s=(a(30541),a(57658),a(63822)),n=a(29958),r=a(40204),o=a(42325),d=a(91494),c=a(46111),m={name:"Admin",components:{adminForm:d["default"]},directives:{waves:r.Z},filters:{statusFilter(e){const t={0:"禁用",1:"正常"};return t[e]}},data(){return{tableKey:0,list:null,total:null,selectedRows:null,listLoading:!0,showSearch:!1,listQuery:{page:1,psize:10,isEnabled:"-1",userName:"",phone:"",realName:"",startTime:"",endTime:""},buttonDisabled:!0,deleting:!1,dateTime:"",pickerOptions:o.Pk,currentIndex:-1}},computed:{...(0,s.Se)(["group","code"])},watch:{dateTime:function(e){this.listQuery.startTime=e[0],this.listQuery.endTime=e[1]}},created(){this.fetchList()},methods:{fetchList(){this.listLoading=!0,this.listQuery.jdName=this.group,this.listQuery.UnitNo=this.code,(0,n.gp)(this.listQuery).then((e=>{this.list=e.data.data,this.total=e.data.total,this.listLoading=!1}))},handleFilter(){this.listQuery.page=1,this.fetchList()},handleFilterClear(){this.listQuery={page:1,psize:10,isEnabled:"-1",userName:"",phone:"",realName:"",startTime:"",endTime:""},this.dateTime="",this.fetchList()},handleSizeChange(e){this.listQuery.psize=e,this.fetchList()},handleCurrentChange(e){this.listQuery.page=e,this.fetchList()},handleModifyStatus(e,t,a){return!1},handleSelectionChange(e){e.length>0?this.buttonDisabled=!1:this.buttonDisabled=!0,this.selectedRows=e},handleImg(e){(0,c.Z)(e,"图片预览","500","400")},handleCreate(){this.$refs.fromAdmin.handleCreate()},handleUpdate(e,t){this.currentIndex=e,this.$refs.fromAdmin.handleUpdate(t)},updateRow(e){this.currentIndex>=0&&e.id>0?this.list.splice(this.currentIndex,1,e):(this.list.length>=10&&this.list.pop(),this.list.unshift(e),this.total=this.total+1),this.currentIndex=-1},handleDelete(e,t){this.$confirm("不能删除该记录","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>!1)).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleDeleteAll(){const e=this;this.selectedRows.length>0?this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.deleting=!0;const t=(0,o.XN)(e.selectedRows,"id"),a=t.join(",");(0,n.yu)({ids:a}).then((a=>{if(1===a.status){const l=[];e.list.forEach((function(e,a,i){t.indexOf(e.id)>-1&&l.push(a)}));for(let t=l.length-1;t>=0;t--)e.list.splice(l[t],1);e.total=e.total-l.length,e.$message.success(a.msg)}else e.$message.error(a.msg);e.deleting=!1})).catch((t=>{e.deleting=!1}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})})):e.$message.error("请选择要删除的数据")},handleCommand(e){const t=this;if(this.selectedRows.length>0){const a=(0,o.XN)(this.selectedRows,"id"),l=a.join(",");(0,n.hc)({val:l,field:"isEnabled",value:e}).then((l=>{1===l.status?(t.list.forEach((function(l,i,s){a.indexOf(l.id)>-1&&(t.list[i]["isEnabled"]=e)})),t.$message.success(l.msg)):t.$message.error(l.msg)})).catch((e=>{}))}else t.$message.error("请选择要操作的数据")}}},u=m,p=a(1001),h=(0,p.Z)(u,l,i,!1,null,"60c709fe",null),f=h.exports},91494:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var l=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"dataForm",staticStyle:{width:"100%",height:"50vh","overflow-y":"scroll"},attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"70px"}},[t("el-form-item",{attrs:{label:"账号",prop:"userName"}},[t("el-input",{attrs:{clearable:""},model:{value:e.temp.userName,callback:function(t){e.$set(e.temp,"userName",t)},expression:"temp.userName"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{clearable:""},model:{value:e.temp.password,callback:function(t){e.$set(e.temp,"password",t)},expression:"temp.password"}})],1),t("el-form-item",{attrs:{label:"头像",prop:"img"}},[t("Upload",{attrs:{config:e.config,UnitNo:e.code},on:{input:function(t){return e.bindingFormImg(t)}},model:{value:e.temp.img,callback:function(t){e.$set(e.temp,"img",t)},expression:"temp.img"}})],1),t("el-form-item",{attrs:{label:"标题",prop:"realName"}},[t("el-input",{attrs:{clearable:""},model:{value:e.temp.realName,callback:function(t){e.$set(e.temp,"realName",t)},expression:"temp.realName"}})],1),t("el-form-item",{attrs:{label:"手机",prop:"phone"}},[t("el-input",{attrs:{clearable:""},model:{value:e.temp.phone,callback:function(t){e.$set(e.temp,"phone",t)},expression:"temp.phone"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{attrs:{clearable:""},model:{value:e.temp.email,callback:function(t){e.$set(e.temp,"email",t)},expression:"temp.email"}})],1),t("el-form-item",{attrs:{label:"状态"}},[t("el-radio-group",{model:{value:e.temp.isEnabled,callback:function(t){e.$set(e.temp,"isEnabled",t)},expression:"temp.isEnabled"}},[t("el-radio",{attrs:{label:1}},[e._v("正常")])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{loading:e.btnLoading,type:"primary"},on:{click:function(t){return e.saveData()}}},[e._v("保存")])],1)],1)},i=[],s=a(63613),n=a(92923),r=a(29958),o=a(12223),d=a(42325),c=a(89176),m=a(61073),u=a(63822),p=a(23518),h={name:"AdminForm",components:{Upload:s.Z},computed:{...(0,u.Se)(["code"])},data(){var e=(e,t,a)=>{if(!(0,c.a$)(t))return a(new Error);a()},t=(e,t,a)=>{if(!(0,c.oH)(t))return a(new Error);a()};return{btnLoading:!1,roles:{},contid:"",contis:!1,temp:{id:0,userName:"",password:"",realName:"",isEnabled:1,phone:"",email:"",regTime:(0,d.Ei)(),img:[]},config:{fileName:"img",limit:1,multiple:!0,accept:"image/*",action:m.Z.uploadUrl.img},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加"},rules:{userName:[{required:!0,message:"账号必填",trigger:"blur"}],phone:[{validator:e,message:"手机号格式错误",trigger:"blur"}],email:[{validator:t,message:"邮箱格式错误",trigger:"blur"}]}}},watch:{dialogFormVisible:function(){p.log(this.contis);let e=this;if(this.contis&&this.temp.img.length>0){let t={img:this.temp.img[0],UnitNo:this.code};(0,o.WB)(t).then((t=>{t.data.unlink&&e.$router.go(0)}))}this.resetTemp()},temp:{handler(){},immediate:!0,deep:!0}},created(){this.getRoles()},destroyed(){},methods:{bindingFormImg(e){let t=this;(0,r.Y1)(this.contid).then((a=>{1===a.status&&(a.data.img==e?t.contis=!1:t.contis=!0)}))},getRoles(){(0,n.Im)().then((e=>{this.roles=e.data}))},resetTemp(){this.temp={id:0,userName:"",password:"",realName:"",isEnabled:1,phone:"",email:"",regTime:(0,d.Ei)(),img:[]}},handleCreate(){this.dialogStatus="create",this.dialogFormVisible=!0,this.currentIndex=-1,this.$nextTick((()=>{this.$refs["dataForm"].clearValidate()}))},handleUpdate(e){this.contid=e,this.dialogStatus="update",this.dialogFormVisible=!0;const t=this;(0,r.Y1)(e).then((e=>{1===e.status&&(t.temp.id=e.data.id,t.temp.userName=e.data.userName,t.temp.realName=e.data.realName,t.temp.isEnabled=e.data.isEnabled,t.temp.phone=e.data.phone,t.temp.email=e.data.email,t.temp.password="",t.temp.img=(0,d.qT)(e.data.img))})),this.$nextTick((()=>{this.$refs["dataForm"].clearValidate()}))},saveData(){this.btnLoading=!0,this.$refs["dataForm"].validate((e=>{if(e){let e=this,t={id:e.temp.id,userName:e.temp.userName,password:e.temp.password,realName:e.temp.realName,isEnabled:e.temp.isEnabled,phone:e.temp.phone,email:e.temp.email,regTime:e.temp.regTime,img:""};e.temp.img.length>0?t.img=e.temp.img[0]:t.img="",(0,r.a1)(t).then((a=>{1===a.status?(t.id||(t.id=a.data.id),e.contis=!1,this.$emit("updateRow",t),e.dialogFormVisible=!1,e.$message.success(a.msg),e.$router.go(0)):e.$message.error(a.msg),e.btnLoading=!1})).catch((e=>{this.btnLoading=!1}))}else this.btnLoading=!1}))}}},f=h,g=a(1001),b=(0,g.Z)(f,l,i,!1,null,null,null),v=b.exports},92923:function(e,t,a){a.d(t,{IV:function(){return c},Im:function(){return s},Y1:function(){return n},a1:function(){return o},fy:function(){return r},gp:function(){return i},hc:function(){return p},m:function(){return m},nV:function(){return d},yu:function(){return u}});var l=a(84471);function i(e){return(0,l.Z)({url:"/admin/roles/index",method:"post",data:e})}function s(){return(0,l.Z)({url:"/admin/roles/getLists",method:"post"})}function n(e){return(0,l.Z)({url:"/admin/roles/getinfo",method:"get",params:{id:e}})}function r(e){return(0,l.Z)({url:"/admin/roles/getinfoList",method:"get",params:{name:e}})}function o(e){return(0,l.Z)({url:"/admin/roles/save",method:"post",data:e})}function d(e){return(0,l.Z)({url:"/admin/roles/saveList",method:"post",data:e})}function c(e){return(0,l.Z)({url:"/admin/roles/del",method:"get",params:{id:e}})}function m(e,t,a){const i={val:e,field:t,value:a};return(0,l.Z)({url:"/admin/roles/change",method:"post",data:i})}function u(e){return(0,l.Z)({url:"/admin/roles/delall",method:"post",data:e})}function p(e){return(0,l.Z)({url:"/admin/roles/changeall",method:"post",data:e})}},40204:function(e,t,a){a.d(t,{Z:function(){return r}});const l="@@wavesContext";function i(e,t){function a(a){const l=Object.assign({},t.value),i=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},l),s=i.ele;if(s){s.style.position="relative",s.style.overflow="hidden";const e=s.getBoundingClientRect();let t=s.querySelector(".waves-ripple");switch(t?t.className="waves-ripple":(t=document.createElement("span"),t.className="waves-ripple",t.style.height=t.style.width=Math.max(e.width,e.height)+"px",s.appendChild(t)),i.type){case"center":t.style.top=e.height/2-t.offsetHeight/2+"px",t.style.left=e.width/2-t.offsetWidth/2+"px";break;default:t.style.top=(a.pageY-e.top-t.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",t.style.left=(a.pageX-e.left-t.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return t.style.backgroundColor=i.color,t.className="waves-ripple z-active",!1}}return e[l]?e[l].removeHandle=a:e[l]={removeHandle:a},a}var s={bind(e,t){e.addEventListener("click",i(e,t),!1)},update(e,t){e.removeEventListener("click",e[l].removeHandle,!1),e.addEventListener("click",i(e,t),!1)},unbind(e){e.removeEventListener("click",e[l].removeHandle,!1),e[l]=null,delete e[l]}};const n=function(e){e.directive("waves",s)};window.Vue&&(window.waves=s,Vue.use(n)),s.install=n;var r=s}}]);